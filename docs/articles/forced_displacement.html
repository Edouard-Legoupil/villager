<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulating Forced Displacement • villager</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulating Forced Displacement">
<meta property="og:description" content="villager">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">villager</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example-boltzman-wealth.html">Boltzman Wealth</a>
    </li>
    <li>
      <a href="../articles/extending-agents.html">extending-agents</a>
    </li>
    <li>
      <a href="../articles/extending-resources.html">extending-resources</a>
    </li>
    <li>
      <a href="../articles/forced_displacement.html">Simulating Forced Displacement</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zizroc/villager/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simulating Forced Displacement</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zizroc/villager/blob/HEAD/vignettes/forced_displacement.Rmd" class="external-link"><code>vignettes/forced_displacement.Rmd</code></a></small>
      <div class="hidden name"><code>forced_displacement.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction-a-digital-laboratory-to-simulate-real-world-challenges">Introduction: A digital laboratory to simulate real-world
challenges<a class="anchor" aria-label="anchor" href="#introduction-a-digital-laboratory-to-simulate-real-world-challenges"></a>
</h2>
<p>Agent-Based Modeling (ABM) is a powerful simulation technique used to
understand and predict complex behaviors and interactions within
systems. In ABM:</p>
<ul>
<li><p>Agent are individual people, each with motivations and
resources.</p></li>
<li><p>Agent evolve within an environment (multiple countries), each
being characterized by different conditions</p></li>
<li><p>Agent may decide to move or not based on factors like safety and
opportunity, that reflects the conditions of the different
countries.</p></li>
<li><p>When agent move, the conditions of the countries can be
affected</p></li>
<li><p>By letting agent interact within a virtual environment, movement
patterns can be predicted in order to design better
interventions</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="agent-based-modeling-for-forced-displacement">Agent-based modeling for Forced Displacement<a class="anchor" aria-label="anchor" href="#agent-based-modeling-for-forced-displacement"></a>
</h2>
<p>In the context of forced displacement, ABM can help us explore how
individuals and groups make migration decisions based on various
factors. This tutorial will guide you through the fundamental components
needed to define an ABM simulation for forced displacement
scenarios.</p>
<div class="section level3">
<h3 id="minimum-ingredients-to-define-a-simulation">Minimum ingredients to define a simulation<a class="anchor" aria-label="anchor" href="#minimum-ingredients-to-define-a-simulation"></a>
</h3>
<ol style="list-style-type: decimal">
<li><strong>Agents</strong></li>
</ol>
<p>Agents represent individuals or entities that interact with their
environment and each other. In our displacement model, agents are
displaced persons whose behaviors are influenced by:</p>
<ul>
<li>Perceived Safety: The level of danger in their current
location.</li>
<li>Access to Resources: Availability of essentials like food, water,
and shelter.</li>
<li>Social Connections: Presence of family, friends, or social networks
in potential destinations.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Rules</strong></li>
</ol>
<p>The rules of behavior define how agents make decisions and behave.
Each agent’s migration decision will depend on:</p>
<ul>
<li>Attributes: Age, health, skills, etc.</li>
<li>Environmental Factors: Safety, resource availability, social
networks in potential destinations.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Environment</strong></li>
</ol>
<p>The environment is the context in which agents operate. It
includes:</p>
<ul>
<li>Origin and Destination Locations: Characteristics of the home
country and potential destinations (e.g., safety levels, resources,
infrastructure).</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Iterations</strong></li>
</ol>
<p>Simulations run in loops or iterations, allowing agents to repeatedly
act or interact over time, reflecting the ongoing nature of displacement
scenarios.</p>
</div>
<div class="section level3">
<h3 id="research-questions-that-can-be-addressed-by-abm">Research Questions that can be Addressed by ABM<a class="anchor" aria-label="anchor" href="#research-questions-that-can-be-addressed-by-abm"></a>
</h3>
<p>ABM can help answer critical questions such as:</p>
<ul>
<li><p><strong>Migration Destinations</strong>: Where are displaced
populations most likely to migrate?</p></li>
<li><p><strong>Influence of Push and Pull Factors</strong>: How do
safety, resources, and social networks influence migration
decisions?</p></li>
<li><p><strong>Impact on Destinations</strong>: How will incoming
populations affect resources and infrastructure in destination
areas?</p></li>
<li><p><strong>Impact on Origins</strong>: How will displacement impact
the social and economic dynamics of the origin location?</p></li>
</ul>
<p>There are therefore numerous added value of such modeling excercise
compared to a simple predictive model:</p>
<ul>
<li><p><strong>Individual-Level Decisions</strong>: ABM captures the
diversity and complexity of individual migration choices.</p></li>
<li><p><strong>Emergent Outcomes</strong>: Observing system-level
consequences of individual actions, identifying potential bottlenecks
and unforeseen impacts.</p></li>
<li><p><strong>Spatial Dynamics</strong>: Realistic representation of
movement through space, considering geographical factors and travel
costs.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="a-dummy-displacement-scenario">A dummy Displacement Scenario<a class="anchor" aria-label="anchor" href="#a-dummy-displacement-scenario"></a>
</h3>
<p>Imagine a political shock event disrupts Country A, causing some of
its citizens to consider migrating to neighboring Countries B, C, and D.
A simplified model can be build to simulate agents (individuals)
deciding whether to move out of their origin country based on a
combination of factors like:</p>
<ul>
<li>Living conditions in origin country (Country A): These worsen due to
the political shock.</li>
<li>Living conditions in destination countries (B, C, D): Each has
varying degrees of attractiveness.</li>
<li>Distance to destination countries: Closer destinations are more
likely to be chosen.</li>
</ul>
<p>To implement a simulation within such scenario, some data will be
required:</p>
<ul>
<li><p><strong>Static Attributes</strong>: Age, gender, health status,
skills, family size, risk tolerance.</p></li>
<li><p><strong>Dynamic Attributes</strong>: Current location,
satisfaction with current location, remaining resources.</p></li>
<li>
<p><strong>Environment</strong>: Includes origin and potential
destination locations with attributes like:</p>
<ul>
<li>Safety levels</li>
<li>Availability of resources (food, water, shelter)</li>
<li>Infrastructure capacity (education, health)</li>
<li>Work Opportunity</li>
<li>Presence of social networks</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="modeling-steps">Modeling Steps<a class="anchor" aria-label="anchor" href="#modeling-steps"></a>
</h2>
<p>The goal is to calculate the number of agents remaining in the origin
country (A) and those who migrated to countries B, C, and D under a
series of assumptions both for the people and the environment (aka
countries characteristics). Country characteristics can be measured by
indexes measuring for instance Safety, Resources, Opportunities,
existence of Citizen network from Country A and available Support
Interventions (for instance “Resource Distribution” like Cash allowance,
“Public services” like free access to School and Education or “Legal
Documentation” to access formal labor employment)</p>
<p>To proceed, one needs to iterate over 5 steps:</p>
<ol style="list-style-type: decimal">
<li>Define Agents</li>
<li>Set up Initial Conditions</li>
<li>Design the Model</li>
<li>Simulate Displacement<br>
</li>
<li>Analyze Results</li>
</ol>
<p>We can do this with a few R libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zizroc/villager/" class="external-link">villager</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># For reproducible simulations</span></span></code></pre></div>
<div class="section level3">
<h3 id="define-agents">1/5. Define Agents<a class="anchor" aria-label="anchor" href="#define-agents"></a>
</h3>
<p>Agents representing citizens of Country A that have specific
attributes.</p>
<p>Citizens in country A with for instance the following agent
characteristics:<br>
- <code>age</code>: Random between 20 and 65. - <code>health</code>:
Random value from a normal distribution. - <code>skills</code>: “Low”,
“Medium”, or “High” (categorical). - <code>family</code>: True if the
agent has family (binary). - <code>risk_tolerance</code>: Random value
between 0 and 1 (uniform distribution). - <code>social_network</code>:
Boolean vector indicating connections only within country A (if family
is present).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A class that extends the villager agent class to have skills, risk tolerance, and country history</span></span>
<span><span class="va">person</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span><span class="st">"agent"</span>,</span>
<span>                         inherit <span class="op">=</span> <span class="fu">villager</span><span class="fu">::</span><span class="va"><a href="../reference/agent.html">agent</a></span>,</span>
<span>                         public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                           age <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           alive <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           children <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           father_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           first_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           gender <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           health <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           identifier <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           last_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           mother_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           partner <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           profession <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           skills <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           risk_tolerance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           country_history <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span></span>
<span>                           initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">identifier</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">first_name</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">last_name</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">age</span> <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                                 <span class="va">mother_id</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">father_id</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">partner</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">children</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span>,</span>
<span>                                                 <span class="va">gender</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">profession</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">alive</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                                 <span class="va">health</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                                 <span class="va">skills</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">risk_tolerance</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                                 <span class="va">country_history</span> <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>                             <span class="co"># Call the base class with the standard values</span></span>
<span>                             <span class="va">super</span><span class="op">$</span><span class="fu">initialize</span><span class="op">(</span><span class="va">identifier</span>,</span>
<span>                                              <span class="va">first_name</span>,</span>
<span>                                              <span class="va">last_name</span>,</span>
<span>                                              <span class="va">age</span>,</span>
<span>                                              <span class="va">mother_id</span>,</span>
<span>                                              <span class="va">father_id</span>,</span>
<span>                                              <span class="va">partner</span>,</span>
<span>                                              <span class="va">children</span>,</span>
<span>                                              <span class="va">gender</span>,</span>
<span>                                              <span class="va">profession</span>,</span>
<span>                                              <span class="va">alive</span>,</span>
<span>                                              <span class="va">health</span><span class="op">)</span></span>
<span></span>
<span>                             <span class="co"># Set the extended class properties</span></span>
<span>                             <span class="va">self</span><span class="op">$</span><span class="va">skills</span> <span class="op">&lt;-</span> <span class="va">skills</span></span>
<span>                             <span class="va">self</span><span class="op">$</span><span class="va">risk_tolerance</span> <span class="op">&lt;-</span> <span class="va">risk_tolerance</span></span>
<span>                             <span class="va">self</span><span class="op">$</span><span class="va">country_history</span> <span class="op">&lt;-</span> <span class="va">country_history</span></span>
<span>                           <span class="op">}</span>,</span>
<span></span>
<span>                           as_table <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>                             <span class="va">agent_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>                               age <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">age</span>,</span>
<span>                               alive <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">alive</span>,</span>
<span>                               father_id <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">father_id</span>,</span>
<span>                               first_name <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">first_name</span>,</span>
<span>                               gender <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">gender</span>,</span>
<span>                               health <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">health</span>,</span>
<span>                               identifier <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">identifier</span>,</span>
<span>                               last_name <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">last_name</span>,</span>
<span>                               mother_id <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">mother_id</span>,</span>
<span>                               partner <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">partner</span>,</span>
<span>                               profession <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">profession</span>,</span>
<span>                               skills <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">skills</span>,</span>
<span>                               risk_tolerance <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">risk_tolerance</span>,</span>
<span>                               country_history <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">country_history</span>, collapse <span class="op">=</span> <span class="st">"-to-"</span><span class="op">)</span></span>
<span>                             <span class="op">)</span></span>
<span>                             <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">agent_table</span><span class="op">)</span></span>
<span>                           <span class="op">}</span></span>
<span>                         <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="set-up-initial-conditions">2/5. Set up Initial Conditions<a class="anchor" aria-label="anchor" href="#set-up-initial-conditions"></a>
</h3>
<p>Set up the environment with Country of origin A and destination
countries (<code>destination_B</code>, <code>destination_C</code>,
<code>destination_D</code>), aka the initial condition. Then a synthetic
Population is generated with 2000 agents for the conflict country
(<code>origin_A</code>) with the attributes defined above.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial_condition</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">current_state</span>, </span>
<span>                              <span class="va">model_data</span>,</span>
<span>                              <span class="va">agent_mgr</span>, </span>
<span>                              <span class="va">resource_mgr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create a normal distribution for health, centered around 80 (1 (nearly dead) to 100 (very healthy))</span></span>
<span>  <span class="va">health_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span>, mean<span class="op">=</span><span class="fl">80</span> , sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="co"># Create a normal distribution for risk tolerance, centered around 60 (1 (tolerate risk) to 100 (do not support insecurity))</span></span>
<span>  <span class="va">risk_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span>, mean <span class="op">=</span> <span class="fl">60</span>, sd<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span>  <span class="co"># Create 2,000 people</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2000</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Assume two genders (female/male)</span></span>
<span>    <span class="va">gender</span> <span class="op">=</span> <span class="st">'female'</span></span>
<span>    <span class="co"># Every even number we assign a male, getting a 50/50 gender split</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">gender</span> <span class="op">=</span> <span class="st">'male'</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># Get a number from the distribution and bound the value between 0 and 1</span></span>
<span>    <span class="co"># Bug: The distribution is picking values exclusively less than 0 and greater than 1</span></span>
<span>    <span class="co"># This is leading to the population having either 0 or 1 tolerance.</span></span>
<span>    <span class="va">risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">risk_norm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">risk</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">risk</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">new_person</span> <span class="op">&lt;-</span> <span class="va"><a href="https://rdrr.io/r/utils/person.html" class="external-link">person</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7300</span>,<span class="fl">23725</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                             gender<span class="op">=</span><span class="va">gender</span>, </span>
<span>                             health<span class="op">=</span><span class="va">health_norm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                             risk_tolerance<span class="op">=</span><span class="va">risk</span>, </span>
<span>                             country_history<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"origin_A"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">agent_mgr</span><span class="op">$</span><span class="fu">add_agent</span><span class="op">(</span><span class="va">new_person</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Randomly pair them, based on made up rules </span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">single_person</span> <span class="kw">in</span> <span class="va">agent_mgr</span><span class="op">$</span><span class="fu">get_living_agents</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Person has to be single</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">single_person</span><span class="op">$</span><span class="va">partner</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Slim chance someone gets married</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Loop over potential mates</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">potential_mate</span> <span class="kw">in</span> <span class="va">agent_mgr</span><span class="op">$</span><span class="fu">get_living_agents</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">potential_mate</span><span class="op">$</span><span class="va">partner</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="co"># Make sure we aren't looking at the single_person agent</span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="va">potential_mate</span><span class="op">$</span><span class="va">identifier</span> <span class="op">!=</span> <span class="va">single_person</span><span class="op">$</span><span class="va">identifier</span><span class="op">)</span> <span class="op">{</span></span>
<span>              <span class="co"># Assume heterosex</span></span>
<span>              <span class="kw">if</span> <span class="op">(</span><span class="va">potential_mate</span><span class="op">$</span><span class="va">gender</span> <span class="op">!=</span> <span class="va">single_person</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="co"># Skip checking age ranges (assume everyone is of age)</span></span>
<span>                <span class="va">agent_mgr</span><span class="op">$</span><span class="fu">connect_agents</span><span class="op">(</span><span class="va">single_person</span>, <span class="va">potential_mate</span><span class="op">)</span></span>
<span>                <span class="co"># Exit inner loop and return to outer</span></span>
<span>                <span class="kw">break</span></span>
<span>              <span class="op">}</span></span>
<span>            <span class="op">}</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># Add a random number of children to married couples. This will allow for the</span></span>
<span>  <span class="co"># idea of family members residing in other countries</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">potential_parent_person</span> <span class="kw">in</span> <span class="va">agent_mgr</span><span class="op">$</span><span class="fu">get_living_agents</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Make sure they're married and no older than... 55?</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">potential_parent_person</span><span class="op">$</span><span class="va">partner</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">potential_parent_person</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">20075</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Some small chance they have kids</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Add three kids</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">risk_norm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>          <span class="va">risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">risk</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>          <span class="va">risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">risk</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>          <span class="va">new_child</span> <span class="op">&lt;-</span> <span class="va"><a href="https://rdrr.io/r/utils/person.html" class="external-link">person</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>age<span class="op">=</span><span class="fl">8030</span>, health <span class="op">=</span> <span class="va">health_norm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, risk_tolerance <span class="op">=</span> <span class="va">risk</span>, country_history <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"origin_A"</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="va">agent_mgr</span><span class="op">$</span><span class="fu">add_agent</span><span class="op">(</span><span class="va">new_child</span><span class="op">)</span></span>
<span>          <span class="va">potential_parent_person</span><span class="op">$</span><span class="fu">add_child</span><span class="op">(</span><span class="va">new_child</span><span class="op">)</span></span>
<span>          <span class="co"># Get the partner</span></span>
<span>          <span class="va">partner</span> <span class="op">&lt;-</span> <span class="va">agent_mgr</span><span class="op">$</span><span class="fu">get_agent</span><span class="op">(</span><span class="va">potential_parent_person</span><span class="op">$</span><span class="va">partner</span><span class="op">)</span></span>
<span>          <span class="va">partner</span><span class="op">$</span><span class="fu">add_child</span><span class="op">(</span><span class="va">new_child</span><span class="op">)</span></span>
<span>          <span class="co"># Add the parents to the child, figure out which is the mom and dad</span></span>
<span>          <span class="kw">if</span> <span class="op">(</span><span class="va">potential_parent_person</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">'male'</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">new_child</span><span class="op">$</span><span class="va">father_id</span> <span class="op">&lt;-</span> <span class="va">potential_parent_person</span><span class="op">$</span><span class="va">identifier</span></span>
<span>            <span class="va">new_child</span><span class="op">$</span><span class="va">mother_id</span> <span class="op">&lt;-</span> <span class="va">partner</span><span class="op">$</span><span class="va">identifier</span></span>
<span>          <span class="op">}</span></span>
<span>          <span class="kw">if</span> <span class="op">(</span><span class="va">potential_parent_person</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">'female'</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">new_child</span><span class="op">$</span><span class="va">mother_id</span> <span class="op">&lt;-</span> <span class="va">potential_parent_person</span><span class="op">$</span><span class="va">identifier</span></span>
<span>            <span class="va">new_child</span><span class="op">$</span><span class="va">father_id</span> <span class="op">&lt;-</span> <span class="va">partner</span><span class="op">$</span><span class="va">identifier</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="design-the-model">3/5. Design the Model<a class="anchor" aria-label="anchor" href="#design-the-model"></a>
</h3>
<p>A score for each destination country based on safety, resources,
affordability (based on skills), potential social network connection in
the destination (if applicable), and opportunity for support, etc.</p>
<p>The agent calculate the attractiveness for each country based then
relates it to his own migration propensity and if the threshold is
reached, chooses the country with the highest score to migrate to.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_forced_displacement</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">current_state</span>,</span>
<span>                           <span class="va">previous_state</span>, </span>
<span>                           <span class="va">model_data</span>, </span>
<span>                           <span class="va">agent_mgr</span>,</span>
<span>                           <span class="va">resource_mgr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Step:"</span>, <span class="va">current_state</span><span class="op">$</span><span class="va">step</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">origin_A_properties</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    living_conditions <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    safety <span class="op">=</span> <span class="fl">2</span> ,</span>
<span>    access_to_healthcare <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    access_to_education <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    access_to_work <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    access_to_cash_allowance <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    network <span class="op">=</span> <span class="fl">8</span> <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">destination_B_properties</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    living_conditions <span class="op">=</span> <span class="fl">7</span>,</span>
<span>    safety <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    access_to_healthcare <span class="op">=</span> <span class="fl">7</span>,</span>
<span>    access_to_education <span class="op">=</span> <span class="fl">7</span>,</span>
<span>    access_to_work <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    access_to_cash_allowance <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    network <span class="op">=</span> <span class="fl">4</span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">destination_C_properties</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    living_conditions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    safety <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    access_to_healthcare <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    access_to_education <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    access_to_work <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    access_to_cash_allowance <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    network <span class="op">=</span> <span class="fl">2</span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">destination_D_properties</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    living_conditions <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    safety <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    access_to_healthcare <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    access_to_education <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    access_to_work <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    access_to_cash_allowance <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    network <span class="op">=</span> <span class="fl">1</span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Decide whether the person moves from one country to the next</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">agent</span> <span class="kw">in</span> <span class="va">agent_mgr</span><span class="op">$</span><span class="fu">get_living_agents</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Age them by a day</span></span>
<span>    <span class="va">agent</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">agent</span><span class="op">$</span><span class="va">age</span><span class="op">+</span><span class="fl">1</span></span>
<span></span>
<span>    <span class="co"># Get the most recent country history (where they currently are)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">agent</span><span class="op">$</span><span class="va">country_history</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">agent</span><span class="op">$</span><span class="va">country_history</span><span class="op">)</span><span class="op">]</span> <span class="op">==</span> <span class="st">'origin_A'</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">where_to_move</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">where_to_move</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">agent</span><span class="op">$</span><span class="va">country_history</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">agent</span><span class="op">$</span><span class="va">country_history</span>, <span class="st">"destination_B"</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">where_to_move</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">agent</span><span class="op">$</span><span class="va">country_history</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">agent</span><span class="op">$</span><span class="va">country_history</span>, <span class="st">"destination_C"</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">where_to_move</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">agent</span><span class="op">$</span><span class="va">country_history</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">agent</span><span class="op">$</span><span class="va">country_history</span>, <span class="st">"destination_D"</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">where_to_move</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Stay in origin_A</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate-displacement">4/5. Simulate Displacement<a class="anchor" aria-label="anchor" href="#simulate-displacement"></a>
</h3>
<p>Using those assumptions, simulation can be performed a certain number
of times. In each iteration, each agent goes through the decision-making
process and potentially updates their location. After each iteration, we
can calculate the final population distribution across destination
countries.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">country_a</span> <span class="op">&lt;-</span> <span class="fu">villager</span><span class="fu">::</span><span class="va"><a href="../reference/village.html">village</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Displacement_Model"</span>,</span>
<span>                                   <span class="va">initial_condition</span>, </span>
<span>                                   <span class="va">model_forced_displacement</span>,</span>
<span>                                   <span class="va">person</span><span class="op">)</span></span>
<span><span class="va">simulation_iterations</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">simulator</span> <span class="op">&lt;-</span> <span class="fu">villager</span><span class="fu">::</span><span class="va"><a href="../reference/Simulation.html">simulation</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulation_iterations</span> ,</span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">country_a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">simulator</span><span class="op">$</span><span class="fu">run_model</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Step: 1"</span></span>
<span><span class="co">#&gt; [1] "Step: 2"</span></span>
<span><span class="co">#&gt; [1] "Step: 3"</span></span>
<span><span class="co">#&gt; [1] "Step: 4"</span></span>
<span><span class="co">#&gt; [1] "Step: 5"</span></span>
<span><span class="co">#&gt; [1] "Step: 6"</span></span>
<span><span class="co">#&gt; [1] "Step: 7"</span></span>
<span><span class="co">#&gt; [1] "Step: 8"</span></span>
<span><span class="co">#&gt; [1] "Step: 9"</span></span>
<span><span class="co">#&gt; [1] "Step: 10"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analyze-results">5/5. Analyze Results<a class="anchor" aria-label="anchor" href="#analyze-results"></a>
</h3>
<p>Note that this example is designed as a template that can be easily
modified to incorporate additional factors like travel cost, language
barriers, or policy changes in destination countries.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load in data that got save automatically</span></span>
<span><span class="va">agent_data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"results/Displacement_Model/agents.csv"</span><span class="op">)</span></span>
<span><span class="va">ressource_data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"results/Displacement_Model/resources.csv"</span><span class="op">)</span></span>
<span><span class="co">#brks &lt;- c(0, 0.25, 0.5, 0.75, 1)</span></span>
<span><span class="co"># Filter the results down to just the last day</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">agent_data</span> <span class="op">|&gt;</span></span>
<span>                <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">step</span> <span class="op">==</span> <span class="va">simulation_iterations</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_infreq</a></span><span class="op">(</span><span class="va">country_history</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#0072BC"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="co"># scale_y_continuous(breaks = brks, labels = scales::percent(brks)) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Forced Displacement Simulation"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Agent Based Modeling Results after "</span>, <span class="va">simulation_iterations</span>, <span class="st">" iterations"</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Dummy Data for illustrative purpose"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Percentage of people"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">unhcrthemes</span><span class="fu">::</span><span class="fu"><a href="https://unhcr-dataviz.github.io/unhcrthemes/reference/theme_unhcr.html" class="external-link">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"X"</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<p><img src="forced_displacement_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter the results down to just the last day</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">agent_data</span> <span class="op">|&gt;</span></span>
<span>         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country_history</span>,  <span class="va">step</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span> <span class="op">(</span> n <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span>  <span class="va">step</span> ,  y <span class="op">=</span> <span class="va">n</span>, group <span class="op">=</span> <span class="va">country_history</span>,  color <span class="op">=</span> <span class="va">country_history</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> size<span class="op">=</span><span class="fl">2</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_d</a></span><span class="op">(</span><span class="st">"Displacement"</span>, option <span class="op">=</span> <span class="st">"plasma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>  labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>accuracy <span class="op">=</span><span class="fl">1</span>, scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Simulation Convergence: Population Displacement"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Agent Based Modeling Results"</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Dummy Data for illustrative purpose"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Simulation Steps"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">unhcrthemes</span><span class="fu">::</span><span class="fu"><a href="https://unhcr-dataviz.github.io/unhcrthemes/reference/theme_unhcr.html" class="external-link">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<p><img src="forced_displacement_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion-model-validation">Conclusion: Model Validation<a class="anchor" aria-label="anchor" href="#conclusion-model-validation"></a>
</h2>
<p>Validation is crucial to ensure the credibility and reliability of an
Agent-Based Model (ABM) for forced displacement. This process involves
comparing the model’s outputs with real-world data and expert
assessments to confirm its accuracy and realism.</p>
<ol style="list-style-type: decimal">
<li>
<strong>Demographic Data</strong>: Demographic data from censuses or
surveys can be instrumental in validating the model. For instance,
population distributions, age structures, and family compositions from
affected areas can be compared with the model’s output to ensure it
accurately reflects the demographic characteristics of the displaced
population.</li>
</ol>
<p><em>Example</em>: If the model predicts that 30% of displaced
individuals are children, this percentage should align with data from
similar past displacement events.</p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Humanitarian Reports</strong>: Reports from humanitarian
organizations provide detailed accounts of displacement events, resource
availability, and the conditions of displaced populations. These reports
can be used to check the model’s predictions about resource needs and
movement patterns.</li>
</ol>
<p><em>Example</em>: If a humanitarian report indicates that access to
education was a critical issue during a displacement event, the model
should similarly reflect resource depletion in areas with high
concentrations of displaced individuals.</p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Research on Displacement Behavior</strong>: Academic and
field research on displacement behaviors and decision-making processes
offers valuable insights into why and how people move during crises.
This research can be used to validate the rules and behaviors encoded in
the model.</li>
</ol>
<p><em>Example</em>: Studies showing that individuals prefer migrating
to areas with existing social networks can be used to verify that the
model accurately simulates this behavior.</p>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>Historical Displacement Patterns</strong>: Comparing the
model’s outputs with historical displacement patterns from similar
events helps validate its predictive power. The model should be able to
replicate known outcomes of past displacement scenarios.</li>
</ol>
<p><em>Example</em>: If historical data show that most displaced persons
from Country A moved to the nearest Country B, the model should produce
similar migration patterns under equivalent conditions.</p>
<ol start="5" style="list-style-type: decimal">
<li>
<strong>Expert Assessment</strong>: Engaging experts in forced
displacement research allows for an evaluation of the model’s behavioral
realism. Experts can provide feedback on whether the model’s
assumptions, rules, and outputs are plausible and consistent with
real-world observations.</li>
</ol>
<p><em>Example</em>: Experts might assess whether the model’s depiction
of migration decision-making under different levels of threat is
realistic.</p>
<ol start="6" style="list-style-type: decimal">
<li>
<strong>Sensitivity Analysis</strong>: Conducting sensitivity
analysis involves varying the model’s parameters to see how changes
affect the outputs. This helps identify which parameters are most
influential and ensures that the model’s predictions are robust across a
range of scenarios.</li>
</ol>
<p><em>Example</em>: By altering parameters such as safety perception or
resource availability, analysts can determine if the model consistently
predicts higher migration rates when safety decreases or resources
become scarce.</p>
</div>
<div class="section level2">
<h2 id="annex-references">Annex: References<a class="anchor" aria-label="anchor" href="#annex-references"></a>
</h2>
<p>Using ABM in Migration and Forced Displacement Studies is not new.
The literature review below is not exhaustive but can provide a first
good overview:</p>
<ul>
<li><p><a href="https://link.springer.com/article/10.1007/s10680-015-9362-0" class="external-link">Decision-Making
in Agent-Based Models of Migration: State of the Art and
Challenges</a></p></li>
<li><p><a href="https://link.springer.com/chapter/10.1007/978-3-030-83039-7_3" class="external-link">Principles
and State of the Art of Agent-Based Migration Modelling</a></p></li>
<li><p><a href="https://ink.library.smu.edu.sg/cgi/viewcontent.cgi?article=4339&amp;context=sis_research" class="external-link">An
agent-based approach to human migration movement</a></p></li>
<li><p><a href="https://link.springer.com/article/10.1007/s42001-020-00076-7" class="external-link">Agent-based
modeling for migration and modern slavery research: a systematic
review</a></p></li>
<li><p><a href="https://www.mdpi.com/2076-0760/11/8/356" class="external-link">A Literature
Review on the Usage of Agent-Based Modelling to Study Policies for
Managing International Migration</a></p></li>
<li><p><a href="https://www.researchgate.net/publication/320453789_A_generalized_simulation_development_approach_for_predicting_refugee_destinations/fulltext/59e63af7a6fdcc0e882481ee/A-generalized-simulation-development-approach-for-predicting-refugee-destinations.pdf" class="external-link">A
generalized simulation development approach for predicting refugee
destinations</a></p></li>
<li><p><a href="https://iiasa.ac.at/projects/agent-based-models-to-inform-economic-policies-on-migration-abm2policy" class="external-link">Agent-based
models to inform economic policies on migration
(ABM2Policy)</a></p></li>
</ul>
<p>On Syria:</p>
<ul>
<li><p><a href="http://ieomsociety.org/proceedings/2022istanbul/187.pdf" class="external-link">Prediction
of Migration Paths Using Agent-Based Simulation Modeling: The Case of
Syria</a></p></li>
<li><p><a href="https://ccl.northwestern.edu/2018/hebert2018.pdf" class="external-link">An
Agent-Based Model to Identify Migration Pathways of Refugees: The Case
of Syria</a></p></li>
<li><p><a href="https://openknowledge.worldbank.org/bitstream/handle/10986/31205/9781464814013.pdf" class="external-link">The
Mobility of Displaced Syrians - An Economic and Social
Analysis</a></p></li>
<li><p><a href="https://zenodo.org/records/8240186" class="external-link">Dynamical Simulation
of the Syrian Refugee Crisis</a></p></li>
</ul>
<p>On Ukraine:</p>
<ul>
<li><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10949908/" class="external-link">An
agent-based framework to study forced migration: A case study of
Ukraine</a></p></li>
<li><p><a href="https://aamas.csc.liv.ac.uk/Proceedings/aamas2024/pdfs/p1372.pdf" class="external-link">Network
Agency: An Agent-based Model of Forced Migration from
Ukraine</a></p></li>
</ul>
<p>On Democratic Republic of Congo:</p>
<ul>
<li><a href="https://www.informs-sim.org/wsc18papers/includes/files/005.pdf" class="external-link">Where
are they headed next? Modeling emergent displaced camps in the DRC using
agent-based models</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Thelen, Gerardo Aldana, Marcus Thomson, Toni Gonzalez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
